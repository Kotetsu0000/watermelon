# スイカゲーム Web アプリ版 開発 ToDo リスト

## 1. 環境構築と基本設定 (P1)

-   [ ] プロジェクトフォルダ作成と Git リポジトリ初期化
-   [ ] `index.html` 基本構造作成 (Canvas 要素含む)
-   [ ] `style.css` 基本スタイリング (背景、Canvas 中央配置)
-   [ ] `main.js` (または適切な名前のファイル) 作成と HTML からの読み込み
-   [ ] Matter.js ライブラリの導入 (CDN またはローカルファイル)
-   [ ] `requestAnimationFrame` を使用した基本的なゲームループ設定 (仕様書 7.2)
-   [ ] Matter.js エンジンの初期化 (ワールド作成、重力設定) (仕様書 3.1, 3.2)
-   [ ] ゲームの境界（箱）となる静的な壁を Matter.js で作成

## 2. フルーツの実装 (P1)

-   [ ] フルーツのデータ構造定義 (種類、進化先、スコア、相対サイズ、画像パス等) (仕様書 2.1)
-   [ ] Matter.js でフルーツの円形ボディを生成する関数作成 (物理プロパティ設定含む) (仕様書 3.2, 4.2)
    -   [ ] フルーツごとの質量、摩擦、反発係数の初期値設定と調整機構
-   [ ] Canvas 上にフルーツの画像を描画する処理 (Matter.js ボディと同期) (仕様書 4.2)

## 3. コアゲームロジック (P1)

-   [ ] **フルーツ落下操作:**
    -   [ ] 次に落下するフルーツのランダム選択ロジック (5 種、均一確率) (仕様書 2.3)
    -   [ ] マウス/タッチの X 座標に追従する落下位置プレビュー (仕様書 7.3)
    -   [ ] クリック/タップでフルーツを落下させる処理 (仕様書 2.2, 7.3)
-   [ ] **フルーツ結合処理:**
    -   [ ] Matter.js 衝突イベント (`collisionStart`) の設定 (仕様書 2.2)
    -   [ ] 同種フルーツ衝突時の進化ロジック (古いフルーツ削除、新しいフルーツ生成) (仕様書 2.2)
        -   [ ] 新しいフルーツの生成位置調整（接触点の中央）
        -   [ ] 結合時のスコア加算処理 (仕様書 2.4)
    -   [ ] スイカ同士の結合時の消滅とスコア加算処理 (仕様書 2.2)
-   [ ] **スコアリングシステム:**
    -   [ ] スコアの管理と UI 表示 (仕様書 2.4, 4.3)
    -   [ ] ハイスコアの localStorage への保存と読み込み (仕様書 2.4)

## 4. ゲームフローと状態管理 (P2)

-   [ ] ゲーム状態管理システムの設計と実装 (開始前, プレイ中, 一時停止, ゲームオーバー) (仕様書 6)
-   [ ] **ゲームオーバー条件判定:**
    -   [ ] フルーツがラインを一定時間超えた場合の判定 (3 秒ルール) (仕様書 2.5)
    -   [ ] 落下フルーツが箱に入らなかった場合の判定 (仕様書 2.5)
-   [ ] **ゲームオーバー処理:** (仕様書 2.5, 4.5)
    -   [ ] 物理演算停止、入力無効化
    -   [ ] 「GAME OVER」表示、最終スコア表示
    -   [ ] リトライボタン機能
-   [ ] **ゲーム開始画面:** (仕様書 4.4)
    -   [ ] 「ゲームスタート」ボタン機能
-   [ ] **一時停止機能:** (仕様書 6)
    -   [ ] 物理演算とゲームタイマーの停止/再開
    -   [ ] 一時停止 UI 表示

## 5. UI/UX 改善 (P2)

-   [ ] 次に落ちてくるフルーツの予告表示 (UI) (仕様書 2.3, 4.3)
-   [ ] ゲーム画面のレスポンシブ対応 (CSS 調整) (仕様書 4.1)
-   [ ] フルーツ画像の準備と差し替え (全 11 種類 + α) (仕様書 4.2)
    -   [ ] 各フルーツの画像サイズと物理ボディサイズの整合性確認
-   [ ] UI 要素のフォント、色、配置の調整 (仕様書 4.3)
-   [ ] 落下位置の視覚的補助（点線など、任意）

## 6. サウンド実装 (P3)

-   [ ] BGM の選定（フリー素材等）と実装 (仕様書 5.1)
    -   [ ] ループ再生、状態に応じた切り替え
    -   [ ] 音量調整機能 (任意)
-   [ ] 効果音の選定（フリー素材等）と実装 (仕様書 5.2)
    -   [ ] フルーツ落下音
    -   [ ] フルーツ衝突音
    -   [ ] フルーツ結合/進化音 (爽快感重視)
    -   [ ] ゲームオーバー音
    -   [ ] 連続結合時の演出用サウンド (任意)

## 7. 物理挙動の調整と最適化 (P2 - P3, 継続的)

-   [ ] **物理パラメータ調整:** (仕様書 3.2)
    -   [ ] 重力、摩擦、反発係数の微調整（ゲームの「手触り」追求）
    -   [ ] フルーツごとの質量調整（小さいフルーツを重くする等、戦略性のため）
    -   [ ] 「ポップコーン現象」のバランス調整
-   [ ] **描画パフォーマンス最適化:** (仕様書 7.2)
    -   [ ] ダブルバッファリング実装 (ちらつき防止)
    -   [ ] `clearRect` の最適化検討
    -   [ ] 不要な Matter.js ボディの適切な削除

## 8. 最終調整とデプロイ (P3)

-   [ ] 全体的なバグ修正と動作テスト
    -   [ ] 複数ブラウザでの動作確認
    -   [ ] スマートフォンでのタッチ操作確認
-   [ ] コードのリファクタリングとコメント追加
-   [ ] アセットパスの確認（GitHub Pages 用） (仕様書 7.4)
-   [ ] GitHub Pages へのデプロイと動作確認

---

**優先度目安:**

-   **P1:** ゲームのコア機能。これがなければ始まらない。
-   **P2:** ゲーム体験を向上させる重要な機能。
-   **P3:** あるとより良くなる機能、仕上げ。

この ToDo リストは開発の進行に合わせて適宜見直し、詳細化してください。
